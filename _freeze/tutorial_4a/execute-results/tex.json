{
  "hash": "f56f0e035c666e704da015430a8cf3ed",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visualizing overlapping points with geom_count()\"\nauthor: \n  - name: Rosa Ottestad\n    url:  \"https://www.linkedin.com/in/rosa-ottestad-718320325/\"\n  - name: Norman Sunde\n    url: \"https://www.linkedin.com/in/norman-sunde/\"\ntoc: true\nnumber-sections: true\nformat:\n  html: default\n  pdf: default\nlightbox: true\nlang: en\neditor_options: \n  chunk_output_type: console\n---\n\n## Overlapping points & `geom_point()`\n\nThe default way to visualize the relationship between two numeric variables is a scatterplot, which can be drawn with the `geom_point()` function in `ggplot2`. Often, however, we work with variables that are only *quasi-numeric*. These variables are, strictly speaking, not numeric but ordinal, yet they have enough categories to allow us to treat them as if they were numeric. Typical examples are measurements of political ideology on 0-10 left-right scales in public opinion surveys or measurements of trust in political actors in the *European Social Survey* (ESS), which are also on 0-10 scales. \n\nThe problem with these variables is that observations can only have a limited number of values: The (integer) numbers from 0 to 10, but nothing in between. When plotting these types of variables with `geom_point()`, this leads to *overplotting*: many different observations that have the exact same values are \"stacked\" on top of each other. In this case, any patterns or relationships between the variables that are plotted are often difficult to see.\n\nThe `geom_count()` function in `ggplot2` addresses this by adding up all duplicate values and then visualizing the number (\"count\") of all observations with same values in the form of differently sized circles. A LOESS curve can then be added to show the overall pattern without assuming a linear relationship. This technique is especially useful for quasi-continuous variables, such as political trust,\nhappiness, or attitudes toward immigrants in the ESS.\n\nWe show how to do this with example data from the ESS as contained in the `bst290` package.\n\n## Example analysis\n### Setup & data management\nThe following two packages are required for this:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --\nv dplyr     1.1.4     v readr     2.1.5\nv forcats   1.0.0     v stringr   1.5.1\nv ggplot2   4.0.0     v tibble    3.2.1\nv lubridate 1.9.4     v tidyr     1.3.1\nv purrr     1.0.4     \n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\ni Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(bst290)\n```\n:::\n\n\nThen we load the dataset:\n\n::: {.cell}\n\n```{.r .cell-code}\ness <- bst290::ess\n```\n:::\n\n\nWe focus on the following two variables from the dataset:\n\n - `ppltrst`: Most people can be trusted (0-10)\n - `imwbcnt`: Immigrants make a country worse or better place to live (0-10)\n\nBefore plotting, we convert these variables to the numeric format:\n\n::: {.cell}\n\n```{.r .cell-code}\ness$ppltrst <- (as.numeric(ess$ppltrst)-1)\ness$imwbcnt <- (as.numeric(ess$imwbcnt)-1)\n```\n:::\n\n\n### Preview: The final plot\n\nThe code to plot the relationship between these variables (and the result) looks as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess,\naes(x = ppltrst,y = imwbcnt))+\ngeom_count()+\ngeom_smooth(method = loess)+\nlabs(x = \"Most people can be trusted (1-10)\",\ny = \"Immigrants make a country worse or better to live(1-10)\",\ntitle = \"Trust in people and attitude towards immigration\")+\ntheme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_sum()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### The process, step-by-step\n\n#### Starting with ggplot()\nThe `ggplot()` function is the foundation of any plot in `ggplot2`:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot()\n```\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n#### Define the dataset\n\nSpecify the dataset you want to use. In this case we are using the ESS practice dataset:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess)\n```\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n#### Set the aesthetics (axes and variables)\n\nDefine which variables youâ€™d like to use and on which axes:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess,\n  aes(x = ppltrst, y = imwbcnt))\n```\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nThis places `ppltrst` on the x-axis and `imwbcnt` on the y-axis. Your independent variable should always be on the x-axis (bottom) and your dependent variable should always be on the y-axis (the left side).\n\n#### Add graph contents with `geom_count()`\n\nThe next step here is to add `geom_count()` to plot the overlapping points:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess,\n  aes(x = ppltrst,y = imwbcnt))+\n  geom_count()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_sum()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n#### Add a smoothed trend line (LOESS)\n\nLOESS adds a smooth curve that highlights the average pattern, along with a 95% confidence band:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess,\n  aes(x = ppltrst,y = imwbcnt))+\n  geom_count()+\n  geom_smooth(method = loess)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_sum()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n#### dd informative labels\nTo finish your graph, add the labels to your axes and a title as you normally would:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess,\n  aes(x = ppltrst,y = imwbcnt))+\n  geom_count()+\n  geom_smooth(method = loess)+\n  labs(x = \"Most people can be trusted (1-10)\",\n  y = \"Immigrants make a country worse or better to live(1-10)\",\n  title = \"Trust in people and attitude towards immigration\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_sum()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-10-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n#### Add theme\n\nWant to score some extra points with your professor? Add a more classic theme (look) to your graph:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess,\n  aes(x = ppltrst,y = imwbcnt)) +\n  geom_count()+\n  geom_smooth(method = loess) +\n  labs(x = \"Most people can be trusted (1-10)\",\n  y = \"Immigrants make a country worse or better to live(1-10)\",\n  Title = \"Trust in people and attitude towards immigration\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nIgnoring unknown labels:\n* Title : \"Trust in people and attitude towards immigration\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_sum()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nOr:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ess,\n  aes(x = ppltrst,y = imwbcnt))+\n  geom_count()+\n  geom_smooth(method = loess )+\n  labs(x = \"Most people can be trusted (1-10)\",\n  y = \"Immigrants make a country worse or better to live(1-10)\",\n  title = \"Trust in people and attitude towards immigration\")+\n  theme_classic()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_sum()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tutorial_4a_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n",
    "supporting": [
      "tutorial_4a_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}